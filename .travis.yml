dist: xenial
language: python
cache: pip

matrix:
  fast_finish: true
  include:
    - python: 3.7
      env: TOXENV=lint
    - python: 3.7
      env: DEPLOYER=true
    - python: 3.6
    - python: 3.8-dev

install:
  - pip install -U pip
  - pip install -U tox-travis

script:
  - tox

after_success:
  - |
    if [ "$TOXENV" != "lint" ]; then
      pip install codecov && codecov
    fi

deploy:
  - provider: pypi
    server: https://test.pypi.org/legacy/
    on:
      tags: false
      repo: hugovk/tinytext
      branch: master
      condition: $DEPLOYER = true
    user: "@token"
    password:
      secure: "V8tmw/GjaN+Yk/eeJCcDEhEKWqyQY7H1cpDKCvATxaBdc4261dbgfKWjpifx8a9ByjW5POY09SuM5spyA8XawnA61RLItUdDi6p/OK2vZ/AGK8gYrvKbsLPzZQoq1/hzNyD9wRQNFcF0d2U4VYNbYiGiwN2qVWe9A1JCWqcwLPeu+ioeDKM2DgPmaa9nViYNtNmsNwWDB+ptztp17zKLaXL7W3Rhe2B4Tid/v8fNqKdkHGuH60VSNL2eqWWWap/yDctTB9nqqpLl9ZOWgWYrZQzyzeMSzUp0s80YCIty+umMC5GdaMZX4qsj4A4dk2sa6sU2IasmHs0kKHNqs3r6QE9TOcxMI1JFPch3jq+i+nRg1bA1E+JjYmlvVdPJhKrlMv/jvDiaukMtFa+Kk52xGXFWwDX5IC+Vedv/xRSVLE2/WgHLGWfV7t0bWeZaUhx3OS2L8eJh4eCRHGG68o0VoXmSPLEM7tzRT0sy1THyLY/nTwFh3/u99kG4xFUQ6TGntRzRCBVFj/bjmvqlLMeOb+yTuIG0bHUG7e+ozYZAGGCUu0VTemlYG0jSmiqU4QeKJS3YSMWuglUTxgg/9LPRj4OJsuhvfOejygz1hERruhMewmpZtNJStEuN2L+Tmxj/pymO8x9QL6unTp+yhH7us+f3CApjY/c275qGhi3nm3I="
    distributions: sdist --format=gztar bdist_wheel
    skip_existing: true
  - provider: pypi
    on:
      tags: true
      repo: hugovk/tinytext
      branch: master
      condition: $DEPLOYER = true
    user: "@token"
    password:
      secure: "V8tmw/GjaN+Yk/eeJCcDEhEKWqyQY7H1cpDKCvATxaBdc4261dbgfKWjpifx8a9ByjW5POY09SuM5spyA8XawnA61RLItUdDi6p/OK2vZ/AGK8gYrvKbsLPzZQoq1/hzNyD9wRQNFcF0d2U4VYNbYiGiwN2qVWe9A1JCWqcwLPeu+ioeDKM2DgPmaa9nViYNtNmsNwWDB+ptztp17zKLaXL7W3Rhe2B4Tid/v8fNqKdkHGuH60VSNL2eqWWWap/yDctTB9nqqpLl9ZOWgWYrZQzyzeMSzUp0s80YCIty+umMC5GdaMZX4qsj4A4dk2sa6sU2IasmHs0kKHNqs3r6QE9TOcxMI1JFPch3jq+i+nRg1bA1E+JjYmlvVdPJhKrlMv/jvDiaukMtFa+Kk52xGXFWwDX5IC+Vedv/xRSVLE2/WgHLGWfV7t0bWeZaUhx3OS2L8eJh4eCRHGG68o0VoXmSPLEM7tzRT0sy1THyLY/nTwFh3/u99kG4xFUQ6TGntRzRCBVFj/bjmvqlLMeOb+yTuIG0bHUG7e+ozYZAGGCUu0VTemlYG0jSmiqU4QeKJS3YSMWuglUTxgg/9LPRj4OJsuhvfOejygz1hERruhMewmpZtNJStEuN2L+Tmxj/pymO8x9QL6unTp+yhH7us+f3CApjY/c275qGhi3nm3I="
    distributions: sdist --format=gztar bdist_wheel
    skip_existing: true
